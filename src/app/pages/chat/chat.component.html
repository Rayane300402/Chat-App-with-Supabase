<main style="height: 100vh; padding-top: 20px; padding-bottom: 20px; display: flex; flex-direction: column;">
    <div class="container-fluid h-100 d-flex flex-column">
        <h3 class="mb-3 text-light">Supa Chat
            <button (click)="logOut()" class="btn btn-light" style="float: right;">Log out</button>
        </h3>
        <div class="card flex-grow-1 d-flex flex-column">
            <div class="d-flex flex-column h-100">
                <!-- Chat messages container with overflow -->

                <div class="chat-messages flex-grow-1 p-4 overflow-auto">
                    @for (msg of this.chats(); track msg) {
                    <div class="chat-message-left pb-4">
                        <div class="me-5">
                            <img src={{msg?.users?.avatar_url}}
                                class="rounded-circle mr-1" alt="Sharon Doe" width="40" height="40">
                            <div class="text-muted small text-nowrap mt-2">{{msg?.created_at | date: 'd/M/yy, h:mm a'}}</div>
                        </div>
                        <div class="flex-shrink-1 bg-light rounded py-2 px-3 ml-3">
                            <div class="fw-bold mb-1 text-decoration-underline">{{msg?.users?.full_name}}</div>
                           {{msg?.text}}
                        </div>
                        <div class="dropdown d-flex align-items-center justify-content-center">
                            <span (click)="openDropDown(msg)" class="ms-5" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="cursor: pointer;">
                                ...
                            </span>
                            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                                <li><a data-bs-toggle="modal" data-bs-target="#exampleModal" class="dropdown-item" href="#">Delete</a></li>
                                <li><a class="dropdown-item" href="#">Edit</a></li>
                            </ul>
                        </div>
                        
                    </div>
                    } @empty {
                    <div class="text-center text-muted mt-5">
                        No chats available. Start a conversation!
                    </div>
                    }
                </div>


                <form [formGroup]="chatForm" (ngSubmit)="onSubmit()">
                    <!-- Input section -->
                    <div class="flex-grow-0 py-3 px-4 border-top">
                        <div class="input-group">
                            <input formControlName="chat_message" type="text" class="form-control"
                                placeholder="Type your message">
                            <button [disabled]="!chatForm.valid" class="btn btn-primary">Send</button>
                        </div>
                    </div>

                </form>

            </div>
        </div>
    </div>
</main>


<app-delete-modal />